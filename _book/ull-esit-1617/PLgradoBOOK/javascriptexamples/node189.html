
<H1><A NAME="SECTION058170000000000000000"><tex2html_anchor_invisible_mark></A>
<A NAME="section:consejosyapp"><tex2html_anchor_mark></A><BR>
Consejos a seguir al escribir un programa <TT>yapp</TT>
</H1>
Cuando escriba un programa <tex2html_verb_mark>2482<tex2html_verb_mark> asegurese
de seguir los siguientes consejos:

<P>

<OL>
<LI>Coloque el punto y coma de separación de reglas en una línea aparte.
Un punto y coma ``pegado'' al final de una regla puede confundirse
con un terminal de la regla.

<P>
</LI>
<LI>Si hay una regla que produce vacío, coloquela en primer lugar y acompáñela de 
un comentario resaltando ese hecho.
</LI>
<LI>Nunca escriba dos reglas de producción en la misma línea.
</LI>
<LI>Sangre convenientemente todas las partes derechas de las reglas
de producción de una variable, de modo que queden
alineadas.
</LI>
<LI>Ponga nombres representativos a sus variables sintácticas. No llame 
<tex2html_verb_mark>2483<tex2html_verb_mark> a una variable que representa el concepto ``lista de parámetros'',
llámela <tex2html_verb_mark>2484<tex2html_verb_mark>.
</LI>
<LI>Es conveniente que declare los terminales simbólicos, esto es, aquellos que 
llevan un identificador asociado. Si no llevan prioridad asociada o no 
es necesaria, use una declaración <tex2html_verb_mark>2486<tex2html_verb_mark>. De esta manera
el lector de su programa se dará cuenta rápidamente que dichos identificadores
no se corresponden con variables sintácticas. Por la misma razón,
si se trata de terminales
asociados con caracteres o cadenas no es tan necesario que los declare, 
a menos que, 
como en el ejemplo de la calculadora para <tex2html_verb_mark>2487<tex2html_verb_mark> y <tex2html_verb_mark>2488<tex2html_verb_mark>,
sea necesario asociarles una
precedencia.
</LI>
<LI>Es importante que use la opción <tex2html_verb_mark>2489<tex2html_verb_mark> para producir
el fichero <tex2html_verb_mark>2490<tex2html_verb_mark> conteniendo información detallada sobre
los conflictos y el autómata. Cuando haya un conflicto shift-reduce
no resuelto busque en el fichero el estado implicado y 
vea que LR(0) items <tex2html_verbatim_mark>#math7177#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37578#</SPAN>
<tex2html_verbatim_mark>mathend000#
y <tex2html_verbatim_mark>#math7178#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37580#</SPAN>
<tex2html_verbatim_mark>mathend000# entran en conflicto.

<P>
</LI>
<LI><A NAME="item:conflictos"><tex2html_anchor_mark></A>Si según el informe de <tex2html_verb_mark>2491<tex2html_verb_mark>
el conflicto se produce ante un terminal <SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37582#</SPAN>
<tex2html_verbatim_mark>mathend000#,
es porque <tex2html_verbatim_mark>#math7179#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37584#</SPAN>
<tex2html_verbatim_mark>mathend000# y
<tex2html_verbatim_mark>#math7180#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37586#</SPAN>
<tex2html_verbatim_mark>mathend000#. Busque las causas por las que esto ocurre 
y modifique su gramática con vistas a eliminar la presencia
del terminal <SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37588#</SPAN>
<tex2html_verbatim_mark>mathend000# en uno de los dos conjuntos implicados
o bien establezca reglas de prioridad entre los terminales
implicados que resuelvan el conflicto.

<P>
</LI>
<LI>Nótese que cuando existe un conflicto de desplazamiento 
reducción entre <tex2html_verbatim_mark>#math7181#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37590#</SPAN>
<tex2html_verbatim_mark>mathend000# 
y  <tex2html_verbatim_mark>#math7182#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37592#</SPAN>
<tex2html_verbatim_mark>mathend000#, el programa
<tex2html_verb_mark>2492<tex2html_verb_mark> contabiliza un error por cada terminal 
<tex2html_verbatim_mark>#math7183#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37594#</SPAN>
<tex2html_verbatim_mark>mathend000#. Por esta razón,
si hay 16 elementos en <tex2html_verbatim_mark>#math7184#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37596#</SPAN>
<tex2html_verbatim_mark>mathend000#,
el analizador <tex2html_verb_mark>2493<tex2html_verb_mark> informará de la existencia
de 16 conflictos <SPAN  CLASS="textbf">shift-reduce</SPAN>,
cuando en realidad se trata de uno sólo. No desespere, 
los conflictos ``auténticos'' suelen
ser menos de los que <tex2html_verb_mark>2494<tex2html_verb_mark> anuncia.

<P>
</LI>
<LI>Si necesita declarar variables globales, inicializaciones, etc.
que afectan la conducta global del analizador, escriba el código 
correspondiente en la cabecera del analizador, protegido
por los delimitadores <tex2html_verb_mark>2496<tex2html_verb_mark> y <tex2html_verb_mark>2497<tex2html_verb_mark>. Estos delimitadores
deberán aparecer en una línea aparte. Por ejemplo:

<P>
<PRE><tex2html_verbatim_mark>verbatim6175#</PRE>

<P>
</LI>
<LI>Si tiene problemas en tiempo de ejecución con el comportamiento del análizador
sintáctico use la opción <tex2html_verb_mark>2498<tex2html_verb_mark> en la llamada al analizador.

<P>
</LI>
<LI>Si trabaja en windows y pasa los ficheros a unix tenga cuidado con la posible
introducción de caractéres espúreos en el fichero. Debido
a la presencia de caractéres de control invisibles, el analizador <tex2html_verb_mark>2499<tex2html_verb_mark> 
pasará a rechazar una gramatica aparentemente correcta.

<P>
</LI>
<LI>Sea consciente de que los analizadores sintáctico y  léxico mantienen
una relación de corutinas en <tex2html_verb_mark>2500<tex2html_verb_mark>: Cada vez que 
el analizador sintáctico necesita un nuevo terminal para decidir que regla de
producción se aplica, llama al analizador léxico, el cuál deberá retornar el siguiente
terminal. La estrategia es diferente de la utilizada en el ejemplo
usado para el lenguaje Tutu en el capítulo 
<A HREF=<tex2html_cr_mark>#chapter:introcomp#17915><tex2html_cr_mark></A>. Allí generabamos en una primera fase
la lista de terminales. Aquí los terminales se generan  de uno en uno
y cada vez que se encuentra uno nuevo se retorna al analizador sintáctico.
La ventaja que tiene este método es que permite colaborar al analizador sintáctico
y al analizador léxico para ``dinámicamente'' modificar la conducta 
del análisis léxico. Por ejemplo en los compiladores del lenguaje C
es común hacer que el analizador léxico cuando descubre un identificador que 
previamente ha sido declarado como identificador de tipo (mediante 
el uso de <tex2html_verb_mark>2501<tex2html_verb_mark>) retorne un terminal <tex2html_verb_mark>2502<tex2html_verb_mark> 
diferente del terminal <tex2html_verb_mark>2503<tex2html_verb_mark>
que caracteriza a los identificadores. Para ello, el analizador
sintáctico, cuando detecta una tal declaración, ``avisa'' al analizador 
léxico para que modifique su conducta. El analizador sintáctico volverá
a avisarlo cuando la declaración del identificador como
identificador de tipo salga de ámbito y pierda
su especial condición.  

<P>
</LI>
<LI>En <tex2html_verb_mark>2504<tex2html_verb_mark> el analizador sintáctico espera que el analizador
léxico devuelva de cada vez una pareja formada por dos escalares.
El primer escalar es la cadena que designa el terminal. A diferencia
de la habitual costumbre <tex2html_verb_mark>2505<tex2html_verb_mark> de codificar los terminales
como enteros, en <tex2html_verb_mark>2506<tex2html_verb_mark> se suelen codificar como cadenas.
La segunda componente de la pareja es el atributo asociado con el terminal.
Si el atributo es un atributo complejo que necesitas representar
mediante un hash o un vector, lo mejor es hacer que esta componente
sea una referencia al objeto describiendo el atributo.
El analizador léxico le indica al sintáctico la
finalización de la entrada enviándole la pareja 
<tex2html_verb_mark>2507<tex2html_verb_mark> formada por la palabra vacía con atributo <tex2html_verb_mark>2508<tex2html_verb_mark>.

<P>
</LI>
<LI>Hay fundamentalmente dos formas de hacer el analizador
léxico: hacerlo destructivo o no destructivo.
En los destructivos se usa el operador de sustitución <tex2html_verb_mark>2509<tex2html_verb_mark>
(véase el ejemplo de la sección 
<A HREF=<tex2html_cr_mark>#section:ejemplodeuso#17916><tex2html_cr_mark></A>), en cuyo caso la entrada procesada
es retirada de la cadena leída.
En los no destructivos utilizamos el operador
de emparejamiento <tex2html_verb_mark>2510<tex2html_verb_mark>. Véase 
el ejemplo de analizador léxico en
la sección <A HREF=<tex2html_cr_mark>#section:heredados#17917><tex2html_cr_mark></A>
(concretamente la subrutina <tex2html_verb_mark>2511<tex2html_verb_mark> en la 
línea 20 del fichero <tex2html_verb_mark>2512<tex2html_verb_mark>)
</LI>
</OL>

<P>
<P><DIV><#37598#><B>Ejemplo  <SPAN CLASS="arabic">35</SPAN>.<SPAN CLASS="arabic">17</SPAN>.<SPAN CLASS="arabic">1</SPAN></B><#37598#> &nbsp; 
<#37601#><I>Consideremos de nuevo el programa <tex2html_verb_mark>2513<tex2html_verb_mark> para producir
árboles para las expresiones en infijo. Supongamos que olvidamos
introducir una prioridad explícita al terminal <tex2html_verb_mark>2514<tex2html_verb_mark>:
</I><PRE><tex2html_verbatim_mark>verbatim6176#</PRE><I>
en este caso al compilar encontraremos conflictos:
</I><PRE><tex2html_verbatim_mark>verbatim6177#</PRE><I>
En tal caso lo que debemos hacer es editar el fichero <tex2html_verb_mark>2515<tex2html_verb_mark>.
El comienzo del fichero es como sigue:
</I><PRE><tex2html_verbatim_mark>verbatim6178#</PRE><I>
Tal y como indica la expresión ...<tex2html_verb_mark>2516<tex2html_verb_mark> ...,
las líneas como la 7, la 8 y siguientes se refieren a conflictos resueltos.
Mas abajo encontraremos información sobre 
la causa de nuestros conflictos no resueltos:
</I><PRE><tex2html_verbatim_mark>verbatim6179#</PRE><I>
Lo que nos informa que los conflictos 
ocurren en el estado 25 ante 4 terminales
distintos. Nos vamos a la parte del fichero 
en la que aparece la información relativa al estado 25. Para ello,
como el fichero es grande, buscamos por la cadena adecuada.
En <tex2html_verb_mark>2517<tex2html_verb_mark> buscaríamos por <tex2html_verb_mark>2518<tex2html_verb_mark>. Las líneas
correspondientes contienen:
</I>
<P>
<I></I><PRE><tex2html_verbatim_mark>verbatim6180#</PRE><I>
El comentario en la línea 308 (<tex2html_verb_mark>2519<tex2html_verb_mark> ...)
indica que por defecto, ante cualquier
otro terminal que no sea uno de los explícitamente listados, 
la acción a tomar por el analizador será reducir por la regla 8.
</I>
<P>
<I>Una revisión a la numeración de la gramática, al comienzo
del fichero <tex2html_verb_mark>2520<tex2html_verb_mark> nos permite ver cuál
es la regla 8:
</I><PRE><tex2html_verbatim_mark>verbatim6181#</PRE><I>
Efectivamente, es la regla de asignación <tex2html_verb_mark>2521<tex2html_verb_mark>.
El conflicto aparece por que los terminales 
<tex2html_verb_mark>2522<tex2html_verb_mark> están en el conjunto FOLLOW(<tex2html_verb_mark>2523<tex2html_verb_mark>)
y también cabe esperarlos respectivamente 
en las reglas 9, 10, 11 y 12 ya que el estado 
25 contiene:
</I>
<P>
<I></I><PRE><tex2html_verbatim_mark>verbatim6182#</PRE><I>
</I>
<P>
<I>Estamos ante un caso en el que se aplica el consejo número
<A HREF=<tex2html_cr_mark>#item:conflictos#17934><tex2html_cr_mark></A>.
Los items de la forma
<tex2html_verbatim_mark>#math7185#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37603#</SPAN>
<tex2html_verbatim_mark>mathend000#, son los
de la forma <tex2html_verb_mark>2524<tex2html_verb_mark>, etc.
El item de la forma <tex2html_verbatim_mark>#math7186#<SPAN CLASS="MATH"><tex2html_image_mark>#tex2html_wrap_inline37605#</SPAN>
<tex2html_verbatim_mark>mathend000# 
es en este caso <tex2html_verb_mark>2525<tex2html_verb_mark>.
</I>
<P>
<I>En efecto, en una expresión como <tex2html_verb_mark>2526<tex2html_verb_mark> se produce
una ambiguedad. ¿Debe interpretarse como <tex2html_verb_mark>2527<tex2html_verb_mark>?
¿O bien como <tex2html_verb_mark>2528<tex2html_verb_mark>?. La primera interpretación
corresponde a reducir por la regla 8. La segunda a desplazar al
estado 13.  En este ejemplo, el conflicto
se resuelve haciendo que tenga prioridad el desplazamiento,
dando menor prioridad al terminal <tex2html_verb_mark>2529<tex2html_verb_mark> que a los 
terminales <tex2html_verb_mark>2530<tex2html_verb_mark>.</I><#37601#></DIV><P></P>


<P>
<P><DIV><#37607#><B>Ejercicio  <SPAN CLASS="arabic">35</SPAN>.<SPAN CLASS="arabic">17</SPAN>.<SPAN CLASS="arabic">1</SPAN></B><#37607#> &nbsp; 
<#37610#><I>¿Que ocurre en el ejemplo anterior si dejamos que <tex2html_verb_mark>2531<tex2html_verb_mark> aplique 
las reglas por defecto?</I><#37610#></DIV><P></P>


<P>
